<!DOCTYPE html>
<html lang="id" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LALA AI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style type="text/tailwindcss">
        @layer base {
            :root {
                --primary-color: #3b82f6; /* Tailwind's blue-500 */
                --primary-hover-color: #2563eb; /* Tailwind's blue-600 */
                --secondary-color: #6b7280; /* Tailwind's gray-500 */
                --bg-light: #f3f4f6; /* Tailwind's gray-100 */
                --card-bg-light: #ffffff; /* Tailwind's white */
                --text-light: #1f2937; /* Tailwind's gray-800 */
                --border-light: #e5e7eb; /* Tailwind's gray-200 */
            }
            .dark {
                --bg-dark: #111827; /* Tailwind's gray-900 */
                --card-bg-dark: #1f2937; /* Tailwind's gray-800 */
                --text-dark: #e5e7eb; /* Tailwind's gray-200 */
                --border-dark: #374151; /* Tailwind's gray-700 */
                --primary-color: #60a5fa; /* Tailwind's blue-400 */
                --primary-hover-color: #3b82f6; /* Tailwind's blue-500 */
            }

            body {
                @apply font-sans bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200 transition-colors duration-500;
            }

            .sidebar {
                @apply bg-white dark:bg-gray-800 shadow-xl fixed top-0 left-0 h-full w-64 transform -translate-x-full lg:translate-x-0 transition-transform duration-500 ease-in-out z-50;
            }
            .sidebar.open {
                @apply translate-x-0;
            }
            .main-content {
                @apply ml-0 lg:ml-64 transition-all duration-500 ease-in-out;
            }
            .card {
                @apply bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 mb-8 transition-colors duration-500;
            }
            .btn-primary {
                @apply bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105;
            }
            .btn-secondary {
                @apply bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 font-bold py-3 px-6 rounded-xl transition-colors duration-300;
            }
            .input, .textarea {
                @apply w-full p-4 border border-gray-300 dark:border-gray-700 rounded-xl bg-gray-50 dark:bg-gray-900 focus:outline-none focus:ring-4 focus:ring-blue-500/30 transition-all duration-300;
            }

            .nav-item {
                @apply flex items-center p-4 text-gray-700 dark:text-gray-300 hover:bg-blue-50 dark:hover:bg-blue-900 transition-all duration-200 ease-in-out rounded-lg mx-2;
            }

            .nav-item.active {
                @apply bg-blue-100 dark:bg-blue-800 text-blue-600 dark:text-blue-200 font-bold shadow-sm;
            }
            
            .chat-message-user {
                @apply bg-blue-600 text-white p-4 rounded-t-2xl rounded-bl-2xl max-w-sm ml-auto animate-fadeInRight;
            }

            .chat-message-ai {
                @apply bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 p-4 rounded-t-2xl rounded-br-2xl max-w-sm mr-auto animate-fadeInLeft;
            }

            @keyframes fadeInRight {
                from { opacity: 0; transform: translateX(20px); }
                to { opacity: 1; transform: translateX(0); }
            }

            @keyframes fadeInLeft {
                from { opacity: 0; transform: translateX(-20px); }
                to { opacity: 1; transform: translateX(0); }
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    animation: {
                        fadeInRight: 'fadeInRight 0.5s ease-out',
                        fadeInLeft: 'fadeInLeft 0.5s ease-out',
                    },
                }
            }
        }
    </script>
</head>
<body class="bg-gray-100 dark:bg-gray-900 transition-colors duration-500">
    <aside id="sidebar" class="sidebar">
        <div class="p-6 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
            <h1 class="text-3xl font-extrabold text-blue-600 dark:text-blue-400">Lala AI</h1>
            <button id="closeSidebar" class="lg:hidden text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors duration-200">
                <i class="fas fa-times text-2xl"></i>
            </button>
        </div>
        <nav class="mt-8 space-y-2">
            <a href="#" class="nav-item active" data-tab="chat">
                <i class="fas fa-comments mr-4 text-xl"></i> Chat AI
            </a>
            <a href="#" class="nav-item" data-tab="translate">
                <i class="fas fa-language mr-4 text-xl"></i> Terjemahkan
            </a>
            <a href="#" class="nav-item" data-tab="image-gen">
                <i class="fas fa-palette mr-4 text-xl"></i> Buat Gambar
            </a>
            <a href="#" class="nav-item" data-tab="image-prompt">
                <i class="fas fa-camera mr-4 text-xl"></i> Gambar ke Deskripsi
            </a>
        </nav>
        <div class="p-6 mt-auto border-t border-gray-200 dark:border-gray-700">
            <button id="themeToggle" class="w-full flex items-center justify-center btn-secondary">
                <i class="fas fa-moon mr-2"></i> Mode Gelap
            </button>
        </div>
    </aside>

    <div id="main-content" class="main-content">
        <nav class="bg-white dark:bg-gray-800 shadow-lg lg:hidden p-4 flex items-center justify-between sticky top-0 z-40 transition-colors duration-500">
            <button id="hamburger" class="text-gray-800 dark:text-gray-200">
                <i class="fas fa-bars text-2xl"></i>
            </button>
            <div class="flex-grow text-center">
                <h1 class="text-2xl font-extrabold text-blue-600 dark:text-blue-400">Lala Smart AI</h1>
            </div>
        </nav>

        <header class="text-center lg:my-12">
            <h1 class="text-5xl font-extrabold text-blue-600 dark:text-blue-400 leading-tight hidden lg:block">LALA SMART AI</h1>
            <!--<p class="text-lg text-gray-500 dark:text-gray-400">Jelajahi kekuatan AI dengan Lala!</p>-->
        </header>

        <div id="chat" class="tab-content p-4 lg:p-8">
            <div class="card">
                <h2 class="text-3xl font-bold mb-6 flex items-center text-gray-800 dark:text-gray-200"><i class="fas fa-comments mr-4 text-blue-500"></i> Chat dengan Lala AI</h2>
                <div id="chatMessages" class="h-[60vh] overflow-y-auto mb-6 p-4 md:p-6 border border-gray-200 dark:border-gray-700 rounded-2xl space-y-4">
                    <div class="flex">
                        <div class="chat-message-ai">
                            Halo kak! Lala siap bantu apa aja. Yuk, ngobrol! ðŸ’–
                        </div>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <input type="text" id="chatInput" class="input flex-grow" placeholder="Ketik pesan di sini...">
                    <button id="sendMessageBtn" class="btn-primary p-4 rounded-xl">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>

        <div id="translate" class="tab-content hidden p-4 lg:p-8">
            <div class="card">
                <h2 class="text-3xl font-bold mb-6 flex items-center text-gray-800 dark:text-gray-200"><i class="fas fa-language mr-4 text-blue-500"></i> Terjemahan</h2>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <div>
                        <label class="block text-sm font-medium mb-2">Teks Asli</label>
                        <textarea id="sourceText" class="textarea h-48 md:h-56" placeholder="Masukkan teks yang ingin diterjemahkan..."></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Hasil Terjemahan</label>
                        <textarea id="translatedText" class="textarea h-48 md:h-56" readonly></textarea>
                    </div>
                </div>
                <div class="flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-4">
                    <select id="fromLang" class="input w-full md:w-48">
                        <option value="id">Bahasa Indonesia</option>
                        <option value="en">English</option>
                        <option value="ja">æ—¥æœ¬èªž</option>
                    </select>
                    <button id="translateBtn" class="btn-primary w-full md:w-auto">Terjemahkan</button>
                    <select id="toLang" class="input w-full md:w-48">
                        <option value="en">English</option>
                        <option value="id">Bahasa Indonesia</option>
                        <option value="ja">æ—¥æœ¬èªž</option>
                    </select>
                </div>
            </div>
        </div>

        <div id="image-gen" class="tab-content hidden p-4 lg:p-8">
            <div class="card">
                <h2 class="text-3xl font-bold mb-6 flex items-center text-gray-800 dark:text-gray-200"><i class="fas fa-palette mr-4 text-blue-500"></i> Buat Gambar</h2>
                <div class="mb-6">
                    <input type="text" id="imagePrompt" class="input" placeholder="Contoh: seekor kucing bermain di taman, gaya anime...">
                </div>
                <div class="flex justify-center items-center mb-6">
                    <button id="generateImageBtn" class="btn-primary">Buat Gambar</button>
                </div>
                <div id="imageResult" class="min-h-[400px] border-4 border-dashed border-gray-300 dark:border-gray-700 rounded-2xl p-4 flex items-center justify-center text-gray-500 dark:text-gray-400">
                    Gambar akan muncul di sini...
                </div>
            </div>
        </div>

        <div id="image-prompt" class="tab-content hidden p-4 lg:p-8">
            <div class="card">
                <h2 class="text-3xl font-bold mb-6 flex items-center text-gray-800 dark:text-gray-200"><i class="fas fa-camera mr-4 text-blue-500"></i> Gambar ke Deskripsi</h2>
                <div class="flex flex-col items-center justify-center p-8 border-4 border-dashed border-gray-300 dark:border-gray-700 rounded-2xl mb-6 cursor-pointer hover:border-blue-500 transition-colors duration-200" id="dropArea">
                    <i class="fas fa-upload text-6xl text-gray-400 mb-4 animate-bounce"></i>
                    <p class="text-lg text-gray-500 dark:text-gray-400">Tarik & Lepas gambar di sini, atau klik untuk unggah</p>
                    <input type="file" id="fileInput" class="hidden" accept="image/*">
                </div>
                <div id="imagePreview" class="hidden mb-6">
                    <img id="uploadedImage" class="max-w-full max-h-[400px] mx-auto rounded-2xl shadow-lg">
                </div>
                <button id="analyzeImageBtn" class="btn-primary w-full mb-6">Analisis Gambar</button>
                <div id="promptResult" class="min-h-[150px] p-6 border border-gray-200 dark:border-gray-700 rounded-2xl text-gray-700 dark:text-gray-300">
                    Deskripsi akan muncul di sini...
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_KEY = "AIzaSyDxAJWd_DqGdUMc0BgyewwsQiwNNuSqW5c";
        const BASE_URL = "https://generativelanguage.googleapis.com/v1beta/models";

        async function callGeminiAPI(endpoint, payload) {
            try {
                const response = await fetch(`${BASE_URL}/${endpoint}?key=${API_KEY}`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(payload),
                });
                
                const result = await response.json();
                
                if (!response.ok) {
                    throw new Error(result.error.message || `API Error: ${response.status}`);
                }
                
                if (!result.candidates || result.candidates.length === 0) {
                    throw new Error("No candidates found in the response.");
                }

                if (!result.candidates[0].content || !result.candidates[0].content.parts) {
                    throw new Error("No content parts found in the response.");
                }
                
                return result.candidates[0].content.parts[0].text;

            } catch (error) {
                console.error("Gemini API call failed:", error);
                throw error;
            }
        }

        // === Navigasi dan Theme ===
        const sidebar = document.getElementById('sidebar');
        const hamburger = document.getElementById('hamburger');
        const closeSidebar = document.getElementById('closeSidebar');
        const navItems = document.querySelectorAll('.nav-item');
        const tabs = document.querySelectorAll('.tab-content');

        hamburger.addEventListener('click', () => {
            sidebar.classList.add('open');
        });

        closeSidebar.addEventListener('click', () => {
            sidebar.classList.remove('open');
        });

        navItems.forEach(item => {
            item.addEventListener('click', (e) => {
                e.preventDefault();
                navItems.forEach(nav => nav.classList.remove('active'));
                item.classList.add('active');
                
                tabs.forEach(tab => tab.classList.add('hidden'));
                const tabId = item.getAttribute('data-tab');
                document.getElementById(tabId).classList.remove('hidden');
                
                sidebar.classList.remove('open');
            });
        });

        const themeToggle = document.getElementById('themeToggle');
        themeToggle.addEventListener('click', () => {
            document.documentElement.classList.toggle('dark');
            const isDarkMode = document.documentElement.classList.contains('dark');
            themeToggle.innerHTML = isDarkMode ? '<i class="fas fa-sun mr-2"></i> Mode Cerah' : '<i class="fas fa-moon mr-2"></i> Mode Gelap';
        });

        // === Fitur Chat ===
        const chatInput = document.getElementById('chatInput');
        const sendMessageBtn = document.getElementById('sendMessageBtn');
        const chatMessages = document.getElementById('chatMessages');

        sendMessageBtn.addEventListener('click', sendMessage);
        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        async function sendMessage() {
            const userText = chatInput.value.trim();
            if (!userText) return;

            const userMessageHTML = `<div class="flex justify-end mb-4"><div class="chat-message-user">${userText}</div></div>`;
            chatMessages.innerHTML += userMessageHTML;
            chatInput.value = '';
            chatMessages.scrollTop = chatMessages.scrollHeight;

            const loadingHTML = `<div id="loading-message" class="flex mb-4"><div class="chat-message-ai"><i class="fas fa-spinner fa-spin mr-2"></i>Lala lagi mikir...</div></div>`;
            chatMessages.innerHTML += loadingHTML;
            chatMessages.scrollTop = chatMessages.scrollHeight;

            try {
                const responseText = await callGeminiAPI("gemini-pro:generateContent", {
                    contents: [{ parts: [{ text: userText }] }],
                });

                const loadingMessage = document.getElementById('loading-message');
                if (loadingMessage) loadingMessage.remove();

                const aiMessageHTML = `<div class="flex mb-4"><div class="chat-message-ai">${responseText}</div></div>`;
                chatMessages.innerHTML += aiMessageHTML;
                chatMessages.scrollTop = chatMessages.scrollHeight;

            } catch (error) {
                const loadingMessage = document.getElementById('loading-message');
                if (loadingMessage) loadingMessage.innerHTML = `<div class="chat-message-ai"><i class="fas fa-exclamation-triangle mr-2"></i>Maaf, ada error: ${error.message}</div>`;
            }
        }

        // === Fitur Terjemahan ===
        const translateBtn = document.getElementById('translateBtn');
        translateBtn.addEventListener('click', translateText);

        async function translateText() {
            const sourceText = document.getElementById('sourceText').value.trim();
            const fromLang = document.getElementById('fromLang').value;
            const toLang = document.getElementById('toLang').value;
            const translatedText = document.getElementById('translatedText');

            if (!sourceText) {
                translatedText.value = 'Teksnya kosong nih, kak!';
                return;
            }

            translatedText.value = 'Lala lagi menerjemahkan...';

            try {
                const prompt = `Translate the following text from language code "${fromLang}" to language code "${toLang}". The text is: "${sourceText}". Just provide the translated text.`;
                const responseText = await callGeminiAPI("gemini-pro:generateContent", {
                    contents: [{ parts: [{ text: prompt }] }],
                });
                translatedText.value = responseText;
            } catch (error) {
                translatedText.value = `Maaf kak, ada error: ${error.message}`;
            }
        }

        // === Fitur Buat Gambar ===
        const generateImageBtn = document.getElementById('generateImageBtn');
        generateImageBtn.addEventListener('click', generateImage);

        async function generateImage() {
            const imagePrompt = document.getElementById('imagePrompt').value.trim();
            const imageResult = document.getElementById('imageResult');
            
            if (!imagePrompt) {
                imageResult.innerHTML = 'Yuk, deskripsikan gambarnya dulu!';
                return;
            }
            
            imageResult.innerHTML = `<i class="fas fa-spinner fa-spin mr-2 text-3xl"></i><p class="mt-4">Lala lagi gambar nih...</p>`;
            
            try {
                // Dummy API untuk simulasi, ganti dengan API Image Gen beneran
                const dummyUrl = `https://dummyimage.com/600x400/1e40af/ffffff.png&text=${encodeURIComponent(imagePrompt)}`;
                imageResult.innerHTML = `
                    <div class="flex flex-col items-center">
                        <img src="${dummyUrl}" alt="Generated Image" class="rounded-xl shadow-md animate-fadeInRight">
                        <a href="${dummyUrl}" download="lala_image.png" class="mt-6 btn-primary">
                            <i class="fas fa-download mr-2"></i>Unduh Gambar
                        </a>
                    </div>
                `;
            } catch (error) {
                imageResult.innerHTML = `Maaf kak, ada error: ${error.message}`;
            }
        }

        // === Fitur Gambar ke Deskripsi ===
        const dropArea = document.getElementById('dropArea');
        const fileInput = document.getElementById('fileInput');
        const imagePreview = document.getElementById('imagePreview');
        const uploadedImage = document.getElementById('uploadedImage');
        const analyzeImageBtn = document.getElementById('analyzeImageBtn');
        const promptResult = document.getElementById('promptResult');

        dropArea.addEventListener('click', () => fileInput.click());
        dropArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropArea.classList.add('border-blue-500', 'bg-blue-50', 'dark:bg-blue-950');
        });
        dropArea.addEventListener('dragleave', () => {
            dropArea.classList.remove('border-blue-500', 'bg-blue-50', 'dark:bg-blue-950');
        });
        dropArea.addEventListener('drop', (e) => {
            e.preventDefault();
            dropArea.classList.remove('border-blue-500', 'bg-blue-50', 'dark:bg-blue-950');
            fileInput.files = e.dataTransfer.files;
            handleFile();
        });
        fileInput.addEventListener('change', handleFile);
        analyzeImageBtn.addEventListener('click', analyzeImage);

        function handleFile() {
            const file = fileInput.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    uploadedImage.src = e.target.result;
                    imagePreview.classList.remove('hidden');
                    dropArea.classList.add('hidden');
                };
                reader.readAsDataURL(file);
            }
        }

        async function analyzeImage() {
            const file = fileInput.files[0];
            if (!file) {
                promptResult.innerHTML = 'Yuk, unggah gambar dulu!';
                return;
            }

            promptResult.innerHTML = `<i class="fas fa-spinner fa-spin mr-2"></i>Lala lagi analisis gambarnya...`;

            try {
                const reader = new FileReader();
                reader.onloadend = async () => {
                    const base64Image = reader.result.split(',')[1];
                    const responseText = await callGeminiAPI("gemini-pro-vision:generateContent", {
                        contents: [{
                            parts: [
                                { text: "Deskripsikan gambar ini secara detail." },
                                { inlineData: { mimeType: file.type, data: base64Image } }
                            ]
                        }]
                    });
                    promptResult.textContent = responseText;
                };
                reader.readAsDataURL(file);
            } catch (error) {
                promptResult.textContent = `Maaf kak, ada error: ${error.message}`;
            }
        }
    </script>
</body>
</html>
